/**
 * jQuery FocusPoint; version: dev
 * Author: J. Menz http://jonathonmenz.com
 * Source: https://github.com/jonom/jquery-focuspoint
 * Copyright (c) 2014 - 2016 J. Menz; MIT License
 * @preserve
 */
!function($,i,t,s){function e(i,t){this.element=i,this.settings=$.extend({},a,t),this.init()}var a={reCalcOnWindowResize:!0,setTransformOrigin:!0,gridOrigin:"left-top"},o=$(),n=17,c=function(i,t){var s=!1;return function(){var e=Array.prototype.slice.call(arguments,0);return s?!1:(s=!0,void setTimeout(function(){s=!1,i.apply(null,e)},t))}},r=function(){$(i).off("resize.focuspoint"),o.length&&(n>0?$(i).on("resize.focuspoint",c(function(){o.focusPoint("adjustFocus")},n)):$(i).on("resize.focuspoint",function(){o.focusPoint("adjustFocus")}))},h=function(i,t){return i-t};$.extend(e.prototype,{init:function(){if(this.$el=$(this.element),this.$image=this.$el.find("img").first(),this.imageW=this.$el.data("imageW"),this.imageH=this.$el.data("imageH"),this.imageRatio=this.imageW/this.imageH,!this.imageW&&!this.imageH)return this.resolveImageSize();var i=this;if($.each(["X","Y"],function(t,s){i["focus"+s]=String(i.$el.data("focus"+s)).split(","),$.each(i["focus"+s],function(t,e){i["focus"+s][t]=parseFloat(e.trim()),"center"===i.settings.gridOrigin&&("X"===s?i["focus"+s][t]=.5*(i["focus"+s][t]+1):i["focus"+s][t]=(i["focus"+s][t]-1)*-.5)}),i["focus"+s].length>1?(i["focus"+s].sort(h),i["focus"+s+"MinStart"]=i["focus"+s][0],i["focus"+s+"MinStop"]=i["focus"+s][1],i["focus"+s]=(i["focus"+s][0]+i["focus"+s][1])/2):i["focus"+s+"MinStart"]=i["focus"+s+"MinStop"]=i["focus"+s]=i["focus"+s][0],i["maxScaleRatio"+s]=1/(i["focus"+s+"MinStop"]-i["focus"+s+"MinStart"])}),this.settings.setTransformOrigin){var t=100*i.focusX+"% "+100*i.focusY+"%";this.$image.css({"webkit-transform-origin":t,"transform-origin":t})}this.$el.addClass("focuspoint-active"),this.adjustFocus(),this.settings.reCalcOnWindowResize&&this.windowOn()},resolveImageSize:function(){if(this.triedAutoResolution)return!1;this.triedAutoResolution=!0;var i=this.$el;$("<img />").one("load",function(){i.data("imageW",this.width),i.data("imageH",this.height),i.focusPoint("init")}).attr("src",this.$image.attr("src"))},windowOn:function(){o=o.add(this.element),r()},windowOff:function(){o=o.not(this.element),r()},setThrottleDuration:function(i){n=i,r()},adjustFocus:function(){var i={},t=!1;return i.containerW=this.$el.width(),i.containerH=this.$el.height(),i.containerW>0&&i.containerH>0&&this.imageW>0&&this.imageH>0?(i.containerRatio=i.containerW/i.containerH,i.scale=1,i.shiftPrimary=0,i.shiftSecondary=0,i.clippingAxis=!1,i.axisScale={X:this.imageRatio/i.containerRatio,Y:i.containerRatio/this.imageRatio},this.imageRatio>i.containerRatio?t=i.clippingAxis="X":this.imageRatio<i.containerRatio&&(t=i.clippingAxis="Y"),void(t?(this["maxScaleRatio"+t]&&i.axisScale[t]>this["maxScaleRatio"+t]?(i.scale=this["maxScaleRatio"+t]/i.axisScale[t],i.shiftSecondary=50*(1-i.scale)+"%",i.shiftPrimary=-100*this["focus"+t+"MinStart"]*i.axisScale[t]*i.scale+"%"):(i.shiftPrimary=.5-this["focus"+t]*i.axisScale[t],i.spareNeg=-1*(i.axisScale[t]-1),i.shiftPrimary>0?i.shiftPrimary=0:i.shiftPrimary<0&&i.shiftPrimary<i.spareNeg&&(i.shiftPrimary=i.spareNeg),i.shiftPrimary=100*i.shiftPrimary+"%"),this.$image.css("X"===t?"width":"height",i.axisScale[t]*i.scale*100+"%"),this.$image.css("X"===t?"height":"width",100*i.scale+"%"),this.$image.css("X"===t?"left":"top",i.shiftPrimary),this.$image.css("X"===t?"top":"left",i.shiftSecondary)):this.$image.css({width:"100%",height:"100%",left:0,top:0}))):!1}}),$.fn.focusPoint=function(i){return this.each(function(){$.data(this,"focusPoint")||$.data(this,"focusPoint",new e(this,i))}),"string"==typeof i?this.each(function(){var t=$(this);t.data("focusPoint")[i]()}):this}}(jQuery,window,document);
