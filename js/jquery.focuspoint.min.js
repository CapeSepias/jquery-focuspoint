/**
 * jQuery FocusPoint; version: v2-dev
 * Author: J. Menz http://jonathonmenz.com
 * Source: https://github.com/jonom/jquery-focuspoint
 * Copyright (c) 2014 - 2016 J. Menz; License TBC
 * @preserve
 */
!function($,i,t,s){function e(i,t){this.element=i,this.settings=$.extend({},a,t),this.init()}var a={reCalcOnWindowResize:!0,setTransformOrigin:!0,legacyGrid:!1},n=$(),o=function(i,t,s){var e;return function(){var a=this,n=arguments,o=function(){e=null,s||i.apply(a,n)},c=s&&!e;clearTimeout(e),e=setTimeout(o,t),c&&i.apply(a,n)}},c=!1,r=function(){c||(c=!0,f(),o(function(){c=!1},250))},f=function(){n.focusPoint("adjustFocus"),c&&(i.requestAnimationFrame?i.requestAnimationFrame(f):setTimeout(f,1e3/15))},h=function(){$(i).off("resize.focuspoint"),n.length&&$(i).on("resize.focuspoint",r)},u=function(i,t){return i-t};$.extend(e.prototype,{init:function(){if(this.$el=$(this.element),this.$image=this.$el.find("img, video").first(),this.imageW=this.$el.data("imageW"),this.imageH=this.$el.data("imageH"),this.imageRatio=this.imageW/this.imageH,!this.imageW&&!this.imageH)return this.resolveImageSize();var i=this;if($.each(["X","Y"],function(t,s){i["focus"+s]=String(i.$el.data("focus"+s)).split(","),$.each(i["focus"+s],function(t,e){i["focus"+s][t]=parseFloat(e.trim()),i.settings.legacyGrid===!0&&("X"===s?i["focus"+s][t]=.5*(i["focus"+s][t]+1):i["focus"+s][t]=(i["focus"+s][t]-1)*-.5)}),i["focus"+s].length>1?(i["focus"+s].sort(u),i["focus"+s+"MinStart"]=i["focus"+s][0],i["focus"+s+"MinStop"]=i["focus"+s][1],i["focus"+s]=(i["focus"+s][0]+i["focus"+s][1])/2):i["focus"+s+"MinStart"]=i["focus"+s+"MinStop"]=i["focus"+s]=i["focus"+s][0],i["maxScaleRatio"+s]=1/(i["focus"+s+"MinStop"]-i["focus"+s+"MinStart"])}),this.settings.setTransformOrigin){var t=100*i.focusX+"% "+100*i.focusY+"%";this.$image.css({"webkit-transform-origin":t,"transform-origin":t})}this.$el.addClass("focuspoint-active"),this.adjustFocus(),this.settings.reCalcOnWindowResize&&this.windowOn()},resolveImageSize:function(){if(this.triedAutoResolution)return!1;this.triedAutoResolution=!0;var i=this.$el;$("<img />").one("load",function(){i.data("imageW",this.width),i.data("imageH",this.height),i.focusPoint("init")}).attr("src",this.$image.attr("src"))},windowOn:function(){n=n.add(this.element),h()},windowOff:function(){n=n.not(this.element),h()},adjustFocus:function(){var i={};if(i.containerW=this.$el.width(),i.containerH=this.$el.height(),!(i.containerW>0&&i.containerH>0&&this.imageW>0&&this.imageH>0))return!1;if(i.containerRatio=i.containerW/i.containerH,i.axisScale={X:this.imageRatio/i.containerRatio,Y:i.containerRatio/this.imageRatio},i.clippingAxis=!1,this.imageRatio>i.containerRatio)i.clippingAxis="X";else{if(!(this.imageRatio<i.containerRatio))return void this.$image.css({width:"100%",height:"100%",left:0,top:0});i.clippingAxis="Y"}i.scale=1,i.shiftPrimary=0,i.shiftSecondary=0,this["maxScaleRatio"+i.clippingAxis]&&i.axisScale[i.clippingAxis]>this["maxScaleRatio"+i.clippingAxis]?(i.scale=this["maxScaleRatio"+i.clippingAxis]/i.axisScale[i.clippingAxis],i.shiftSecondary=50*(1-i.scale)+"%",i.shiftPrimary=-100*this["focus"+i.clippingAxis+"MinStart"]*i.axisScale[i.clippingAxis]*i.scale+"%"):(i.shiftPrimary=.5-this["focus"+i.clippingAxis]*i.axisScale[i.clippingAxis],i.spareNeg=-1*(i.axisScale[i.clippingAxis]-1),i.shiftPrimary>0?i.shiftPrimary=0:i.shiftPrimary<0&&i.shiftPrimary<i.spareNeg&&(i.shiftPrimary=i.spareNeg),i.shiftPrimary=100*i.shiftPrimary+"%"),"X"===i.clippingAxis?this.$image.css({width:i.axisScale[i.clippingAxis]*i.scale*100+"%",height:100*i.scale+"%",left:i.shiftPrimary,top:i.shiftSecondary}):this.$image.css({width:100*i.scale+"%",height:i.axisScale[i.clippingAxis]*i.scale*100+"%",left:i.shiftSecondary,top:i.shiftPrimary})}}),$.fn.focusPoint=function(i){return this.each(function(){$.data(this,"focusPoint")||$.data(this,"focusPoint",new e(this,i))}),"string"==typeof i?this.each(function(){var t=$(this);t.data("focusPoint")[i]()}):this}}(jQuery,window,document);